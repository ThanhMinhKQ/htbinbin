<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>ƒêƒÉng Nh·∫≠p H·ªá Th·ªëng</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            primary: '#2563eb',
            accent: '#111827'
          }
        }
      }
    }
  </script>
 <style>
    html, body {
      margin: 0;
      padding: 0;
      min-height: 100dvh;
      width: 100%;
      overscroll-behavior: none;
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(to bottom right, #f4f7fa, #e9eafc);
      padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);
    }

    @keyframes fade-in {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .animate-fade-in {
      animation: fade-in 0.4s ease-out;
    }

    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      20%, 60% { transform: translateX(-6px); }
      40%, 80% { transform: translateX(6px); }
    }

    .animate-shake {
      animation: shake 0.4s ease;
    }

    @keyframes login-success {
      from {
        opacity: 1;
        transform: scale(1);
      }
      to {
        opacity: 0;
        transform: scale(1.1);
      }
    }

    .animate-login-success {
      animation: login-success 0.8s ease forwards;
    }

    /* Cho form t·ª± co ch·ª© kh√¥ng scale to√†n b·ªô */
    #loginBox {
      width: 100%;
      max-width: 420px;
      margin: auto;
      box-sizing: border-box;
    }

    /* Khi m√†n h√¨nh qu√° th·∫•p, co nh·∫π padding b√™n trong thay v√¨ co c·∫£ form */
    @media (max-height: 500px) {
      #loginBox {
        padding-top: 1rem !important;
        padding-bottom: 1rem !important;
      }
    }

    /* Khi xoay ngang nh∆∞ng m√†n nh·ªè ‚Üí co kho·∫£ng c√°ch vi·ªÅn, kh√¥ng co n·ªôi dung */
    @media screen and (orientation: landscape) and (max-height: 420px) {
      html, body {
        padding: 1rem !important;
        align-items: center;
      }

      #loginBox {
        padding: 1rem !important;
        max-width: 95%;
      }
      #loginBox {
        background: rgba(255, 255, 255, 0.12);
        border: 1px solid rgba(255, 255, 255, 0.2);
        backdrop-filter: blur(15px);
        box-shadow: 0 8px 32px rgba(0,0,0,0.3);
        border-radius: 20px;
      }

      #loginBox:hover {
        transform: scale(1.03);
        box-shadow: 0 12px 40px rgba(0, 0, 0, 0.35);
      }
    }
</style>

</head>
<body class="h-[100dvh] flex items-center justify-center px-4 pt-[env(safe-area-inset-top)] pb-[env(safe-area-inset-bottom)] bg-white/80 dark:bg-gradient-to-br dark:from-[#1f2233] dark:to-[#2b2f4a] backdrop-blur-xl dark:from-[#18192a] dark:to-[#23243a] text-gray-800 dark:text-gray-100">

  <div id="loginBox" class="relative w-full max-w-sm sm:max-w-md p-5 sm:p-6 rounded-2xl bg-white/80 dark:bg-gradient-to-br dark:from-[#1f2233] dark:to-[#2b2f4a] backdrop-blur-xl rounded-3xl shadow-2xl p-6 flex flex-col justify-between min-h-[260px] cursor-pointer hover:scale-[1.03] hover:shadow-[0_8px_30px_rgba(0,0,0,0.3)] transition-transform duration-200">

    <!-- Toggle dark mode -->
    <div class="absolute top-3 right-3 z-10">
      <button id="toggleDark" title="Chuy·ªÉn ch·∫ø ƒë·ªô t·ªëi/s√°ng" class="p-2 rounded-full bg-white/80 dark:bg-[#23243a] hover:bg-blue-100 dark:hover:bg-indigo-900 transition">
        <svg id="themeIcon" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-blue-600 dark:text-indigo-300" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M12 3v1m0 16v1m8.66-11.66l-.7.7M4.34 6.34l-.7.7M21 12h-1M4 12H3m16.66 4.66l-.7-.7M6.34 17.66l-.7-.7M12 5a7 7 0 100 14 7 7 0 000-14z" />
        </svg>
      </button>
    </div>

    <!-- Logo v√† ti√™u ƒë·ªÅ -->
    <div class="text-center mb-4">
      <img src="/static/logo.png" alt="Logo" class="mx-auto h-10 mb-2">
      <h1 class="text-xl font-semibold">ƒêƒÉng Nh·∫≠p H·ªá Th·ªëng</h1>
    </div>

    <!-- Th√¥ng b√°o l·ªói -->
    {% if error %}
    <div class="mb-3 text-xs text-red-500 font-medium bg-red-100 dark:bg-red-900 dark:text-red-300 py-1.5 px-3 rounded animate-shake text-center">
      {{ error }}
    </div>
    {% endif %}

    <!-- Form -->
    <form method="post" action="/login" class="space-y-4 text-sm">
      <div>
        <label for="username" class="block font-medium mb-1">M√£ nh√¢n vi√™n</label>
        <div class="relative">
          <input type="text" id="username" name="username" required
            class="w-full pl-10 pr-3 py-1.5 border border-gray-300 dark:border-[#35377b]/40 bg-white dark:bg-[#23243a] text-gray-900 dark:text-gray-100 rounded-md focus:ring-2 focus:ring-blue-400 placeholder:text-gray-400 dark:placeholder:text-gray-500"
            placeholder="Nh·∫≠p m√£ nh√¢n vi√™n" />
          <div class="absolute left-3 top-2.5 text-gray-400 dark:text-gray-300">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M5.121 17.804A9.003 9.003 0 0012 21a9.003 9.003 0 006.879-3.196M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
            </svg>
          </div>
        </div>
      </div>

      <div>
        <label for="password" class="block font-medium mb-1">M·∫≠t kh·∫©u</label>
        <div class="relative">
          <input type="password" id="password" name="password" required
            class="w-full pl-10 pr-10 py-1.5 
                  bg-white dark:bg-[#23243a] 
                  border border-gray-300 dark:border-[#35377b]/40 
                  text-gray-900 dark:text-gray-100 
                  rounded-md 
                  placeholder:text-gray-400 dark:placeholder:text-gray-500 
                  focus:ring-2 focus:ring-blue-400 
                  focus:bg-white dark:focus:bg-[#23243a]"
            placeholder="Nh·∫≠p m·∫≠t kh·∫©u" />
          <div class="absolute left-3 top-2.5 text-gray-400 dark:text-gray-300">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M12 11c0-1.105.895-2 2-2h.586a1 1 0 01.707.293l2.414 2.414a1 1 0 010 1.414l-2.414 2.414A1 1 0 0114.586 16H14a2 2 0 01-2-2v-3z" />
            </svg>
          </div>
          <button type="button" id="togglePassword" class="absolute right-3 top-2.5 text-gray-400 dark:text-gray-300 hover:text-gray-600">
            <svg id="eyeIcon" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
            </svg>
          </button>
        </div>
      </div>

      <button type="submit"
        class="w-full bg-gradient-to-r from-green-500 to-blue-500 hover:from-blue-600 hover:to-green-600 text-white font-semibold py-1.5 rounded-md transition shadow-md">
        ƒêƒÉng nh·∫≠p
      </button>

      <div class="text-center">
        <button type="button" onclick="alert('Vui l√≤ng li√™n h·ªá qu·∫£n l√Ω ƒë·ªÉ ƒë·∫∑t l·∫°i m·∫≠t kh·∫©u.')"
          class="text-xs text-blue-600 dark:text-blue-400 hover:underline">
          Qu√™n m·∫≠t kh·∫©u?
        </button>
      </div>
    </form>

    <p class="mt-4 text-xs text-center text-gray-400 dark:text-gray-400 italic">
      &copy; {{ now.year if now else "2025" }} Bin Bin Hotel. All rights reserved.
    </p>
  </div>

  <script>
    const togglePassword = document.getElementById("togglePassword");
    const passwordInput = document.getElementById("password");
    const eyeIcon = document.getElementById("eyeIcon");
    togglePassword.addEventListener("click", () => {
      const isHidden = passwordInput.type === "password";
      passwordInput.type = isHidden ? "text" : "password";
      eyeIcon.innerHTML = isHidden
        ? `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
             d="M13.875 18.825A10.05 10.05 0 0112 19c-4.477 0-8.268-2.943-9.542-7a9.964 9.964 0 012.185-3.412M15 12a3 3 0 00-4.243-2.829M3 3l18 18" />`
        : `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
             d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
           <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
             d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />`;
    });

    const toggleDark = document.getElementById("toggleDark");
    const html = document.documentElement;
    if (localStorage.theme === "dark") html.classList.add("dark");
    toggleDark.addEventListener("click", () => {
      html.classList.toggle("dark");
      localStorage.theme = html.classList.contains("dark") ? "dark" : "light";
    });

    // Xo√° l·ªói kh·ªèi URL n·∫øu c√≥
    if (window.location.search.includes("error=")) {
      const url = new URL(window.location.href);
      url.searchParams.delete("error");
      url.searchParams.delete("role");
      window.history.replaceState({}, document.title, url.pathname);
    }

    // üëâ Hi·ªáu ·ª©ng ƒëƒÉng nh·∫≠p th√†nh c√¥ng
    if (window.location.search.includes("success=1")) {
      const loginBox = document.getElementById("loginBox");
      loginBox.classList.add("animate-login-success");

      // ƒê·ª£i animation (0.8s) ho√†n t·∫•t r·ªìi chuy·ªÉn trang
      setTimeout(() => {
          window.location.href = "/choose-function";
      }, 800);
    }
  </script>

<!-- Canvas Cosmic Background -->
<canvas id="cosmicCanvas" class="fixed inset-0 z-[-10]"></canvas>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const canvas = document.getElementById('cosmicCanvas');
    const ctx = canvas.getContext('2d');
    let w, h, particles = [];

    function resize() {
      w = canvas.width = window.innerWidth;
      h = canvas.height = window.innerHeight;
    }
    resize();
    window.addEventListener('resize', resize);

    // Star (Dark Mode)
    function Star() {
      this.x = Math.random() * w;
      this.y = Math.random() * h;
      this.radius = Math.random() * 1.2;
      this.vx = (Math.random() - 0.5) * 0.1;
      this.vy = (Math.random() - 0.5) * 0.1;
      this.opacity = Math.random() * 0.5 + 0.2;
    }

    // Cloud (Light Mode) n√¢ng c·∫•p
function Cloud() {
    this.x = Math.random() * w;
    this.y = Math.random() * h * 0.5;
    this.size = 50 + Math.random() * 100;
    this.vx = 0.15 + Math.random() * 0.25;
    this.opacity = 0.1 + Math.random() * 0.2;
    this.layer = Math.random() > 0.5 ? 1 : 2; // layer 1 (l·ªõn ch·∫≠m) v√† layer 2 (nh·ªè nhanh)
}

// V·∫Ω m√¢y d·∫°ng c·ª•m tr√≤n gradient
function drawCloud(c) {
    const gradient = ctx.createRadialGradient(c.x, c.y, 0, c.x, c.y, c.size);
    gradient.addColorStop(0, `rgba(255, 255, 255, ${c.opacity})`);
    gradient.addColorStop(1, `rgba(255, 255, 255, 0)`);

    ctx.fillStyle = gradient;
    ctx.beginPath();
    ctx.arc(c.x, c.y, c.size, 0, Math.PI * 2);
    ctx.fill();

    // C·ª•m tr√≤n nh·ªè quanh m√¢y ƒë·ªÉ t·∫°o c·ª•m m·ªÅm m·∫°i
    for (let i = 0; i < 4; i++) {
        const offsetX = (Math.random() - 0.5) * c.size * 0.6;
        const offsetY = (Math.random() - 0.5) * c.size * 0.3;
        const smallRadius = c.size * (0.3 + Math.random() * 0.2);
        const smallGradient = ctx.createRadialGradient(c.x + offsetX, c.y + offsetY, 0, c.x + offsetX, c.y + offsetY, smallRadius);
        smallGradient.addColorStop(0, `rgba(255, 255, 255, ${c.opacity * 0.8})`);
        smallGradient.addColorStop(1, `rgba(255, 255, 255, 0)`);
        ctx.fillStyle = smallGradient;
        ctx.beginPath();
        ctx.arc(c.x + offsetX, c.y + offsetY, smallRadius, 0, Math.PI * 2);
        ctx.fill();
    }
}

    function createParticles(count, type) {
      particles = [];
      for (let i = 0; i < count; i++) {
        particles.push(type === 'star' ? new Star() : new Cloud());
      }
    }

    function drawGradient() {
      ctx.clearRect(0, 0, w, h);
      const gradient = ctx.createLinearGradient(0, 0, w, h);
      if (document.documentElement.classList.contains('dark')) {
        gradient.addColorStop(0, "#0f2027");
        gradient.addColorStop(0.5, "#203a43");
        gradient.addColorStop(1, "#2c5364");
      } else {
        gradient.addColorStop(0, "#a1c4fd");
        gradient.addColorStop(0.5, "#c2e9fb");
        gradient.addColorStop(1, "#fbc2eb");
      }
      ctx.fillStyle = gradient;
      ctx.fillRect(0, 0, w, h);
    }

    function animate() {
      drawGradient();
      if (document.documentElement.classList.contains('dark')) {
        particles.forEach(s => {
          ctx.beginPath();
          ctx.arc(s.x, s.y, s.radius, 0, Math.PI * 2);
          ctx.fillStyle = `rgba(255, 255, 255, ${s.opacity})`;
          ctx.fill();
          s.x += s.vx;
          s.y += s.vy;
          if (s.x < 0 || s.x > w) s.vx *= -1;
          if (s.y < 0 || s.y > h) s.vy *= -1;
        });
      } else {
        particles.forEach(c => {
          ctx.beginPath();
          ctx.ellipse(c.x, c.y, c.size, c.size * 0.6, 0, 0, 2 * Math.PI);
          ctx.fillStyle = `rgba(255, 255, 255, ${c.opacity})`;
          ctx.fill();
          c.x += c.vx;
          if (c.x - c.size > w) c.x = -c.size;
        });
      }
      requestAnimationFrame(animate);
    }

    function initialize() {
      if (document.documentElement.classList.contains('dark')) {
        createParticles(120, 'star');
      } else {
        createParticles(25, 'cloud');
      }
    }

    initialize();
    animate();

    const toggleDark = document.getElementById("toggleDark");
    if (toggleDark) {
      toggleDark.addEventListener("click", () => {
        setTimeout(() => {
          initialize();
          drawGradient();
        }, 300);
      });
    }

    window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', () => {
      setTimeout(() => {
        initialize();
        drawGradient();
      }, 300);
    });
});
</script>
</body>
</html>
